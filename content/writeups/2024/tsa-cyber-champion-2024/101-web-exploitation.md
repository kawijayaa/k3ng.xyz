---
icon: globe
---

# 101 - Web Exploitation

### Challenge Description

**Web Hacking 101**

_Author: Fedra_

### Flag

`TSA{Web_Hacking_101_c7319b0bd96f9d01981bbf52ebb7027f}`

***

### Analysis

We are given a website without any source code provided. From the main page, we can see the website has a ping functionality and a file upload functionality. When accessing the file upload page, the website uses a query parameter to include the page, meaning that an LFI could happen here.

<figure><img src="../../.gitbook/assets/Screenshot 2024-11-10 130227.png" alt=""><figcaption><p>Query parameter vulnerable to LFI</p></figcaption></figure>

After using `../../../../etc/passwd` as the value of `page`, we confirmed an LFI vulnerability.

<figure><img src="../../.gitbook/assets/Screenshot 2024-11-10 130118.png" alt=""><figcaption><p>Accessing the /etc/passwd file from the query parameter</p></figcaption></figure>

### Solution

Since the file is included, we can get an RCE by uploading a file. With the file upload functionality restricted to only allowing images, we can embed PHP code on the metadata.

<figure><img src="../../.gitbook/assets/Screenshot 2024-11-10 130441.png" alt=""><figcaption><p>PNG image containing PHP code</p></figcaption></figure>

After uploading the file and accessing the file from the query parameter, we could run any Unix command from the `asdf` parameter. When running the `ls /` command, we found a file called `flag_c7319b0bd96f9d01981bbf52ebb7027f.txt`.&#x20;

<figure><img src="../../.gitbook/assets/Screenshot 2024-11-10 130555.png" alt=""><figcaption><p>Listing the root directory</p></figcaption></figure>

We just need to `cat` the file to get the flag.

<figure><img src="../../.gitbook/assets/Screenshot 2024-11-10 130636.png" alt=""><figcaption><p>Outputting the flag</p></figcaption></figure>
